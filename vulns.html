<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/x-icon" href="https://ik94g-g2ilo0g24kig24-f4ig4h79g4inuy-p.netlify.app/pfp.jpg" />
<title>Vulnerabilidades Avanzadas en Aplicaciones Web</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, sans-serif;
    background-color: #111;
    color: #ddd;
    line-height: 1.6;
    padding: 20px;
  }
  .content {
    max-width: 950px;
    background: #1b1b1b;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 0 15px rgba(0,0,0,0.6);
  }
  h1, h2, h3 {
    color: #ff5252;
    margin-top: 25px;
  }
  code {
    background: #000;
    padding: 3px 6px;
    border-radius: 4px;
    font-size: 0.9em;
    color: #9be9a8;
  }
  ul {
    margin-left: 20px;
  }
  li {
    margin-bottom: 8px;
  }
  a {
    color: #66d9ef;
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
<div class="content">
  <h1>Vulnerabilidades Avanzadas en Aplicaciones Web</h1>
  <p>Como ya he explicado muchas veces qué es un <strong>XSS</strong>, <strong>SQLi</strong> y similares, hoy paso a algo más avanzado, que ya entra en un terreno más técnico y menos obvio para el usuario medio. Vamos a tocar <strong>SSRF</strong>, <strong>CSRF</strong>, problemas con plantillas inseguras (<strong>SSTI</strong>), <strong>DWR</strong> y otras cosillas que, si te las cruzas, pueden darte acceso a sitios donde ni el admin debería meterse sin pensarlo dos veces.</p>

  <h2>SSRF (Server-Side Request Forgery)</h2>
  <p>Permite que un atacante haga que el servidor haga peticiones HTTP donde no debería. Esto es como usar el servidor como proxy para llegar a sitios internos o servicios que desde fuera están cerrados.</p>
  <ul>
    <li>Ejemplo de payload básico: <code>http://victima.com/fetch?url=http://127.0.0.1:8080/admin</code></li>
    <li>Se usa para acceder a paneles internos, leer metadatos de la nube (<code>http://169.254.169.254/latest/meta-data/</code>), o incluso lanzar ataques contra otros sistemas desde dentro.</li>
    <li>Mitigación: lista blanca estricta, rechazar IPs privadas, sanitizar URLs y usar timeouts.</li>
  </ul>

  <h2>CSRF (Cross-Site Request Forgery)</h2>
  <p>Este no ataca al servidor directamente, sino que engaña al navegador de una víctima autenticada para que haga peticiones que ella no quería hacer.</p>
  <ul>
    <li>Un clásico: el usuario abre un enlace malicioso y sin darse cuenta hace un <code>POST</code> que cambia su email o contraseña.</li>
    <li>Se arregla usando tokens únicos por sesión (<code>CSRF tokens</code>), y verificando origen (<code>Origin</code>, <code>Referer</code>).</li>
  </ul>

  <h2>SSTI (Server-Side Template Injection)</h2>
  <p>Cuando los datos de usuario se insertan directamente en plantillas sin validación, y el motor de plantillas permite ejecución de código.</p>
  <ul>
    <li>Ejemplo con Jinja2: <code>{{7*7}}</code> devuelve 49 si es vulnerable.</li>
    <li>Puedes llegar a ejecutar código en el servidor si consigues abusar de objetos y métodos internos.</li>
    <li>Prevención: no meter datos directos, escapar siempre, usar <code>autoescape</code> y entornos restringidos.</li>
  </ul>

  <h2>DWR (Direct Web Remoting)</h2>
  <p>Es una librería Java que expone métodos del lado servidor para que el cliente los llame como si fueran JavaScript. Muy cómodo para devs, pero si no está bien configurado, es como dejar la puerta de atrás abierta.</p>
  <ul>
    <li>Ejemplo de rutas que pueden aparecer:  
      <code>/dwr/call/plaincall/UsuarioService.getUsuario.dwr</code>  
      <code>/dwr/call/plaincall/AdminService.getConfig.dwr</code></li>
    <li>Si está mal asegurado, podrías:
      <ul>
        <li>Llamar métodos internos que no deberían ser accesibles.</li>
        <li>Exfiltrar datos como listas de usuarios, configs, etc.</li>
        <li>Incluso ejecutar acciones administrativas si no hay controles.</li>
      </ul>
    </li>
    <li>Mitigación: limitar métodos expuestos, filtrar por roles, desactivar DWR si no se usa.</li>
  </ul>

  <h2>Otros vectores menos hablados</h2>
  <ul>
    <li><strong>Open Redirect</strong>: si dejas que el usuario elija a dónde redirigir, puedes ser usado en phishing. Ejemplo: <code>/redir?url=http://phish.com</code></li>
    <li><strong>Path Traversal</strong>: abusar de <code>../</code> para leer ficheros fuera de la carpeta prevista. Ejemplo: <code>/view?file=../../etc/passwd</code></li>
    <li><strong>Deserialización insegura</strong>: enviar objetos maliciosos que, al deserializar, ejecutan código.</li>
    <li><strong>Header Injection</strong>: inyectar cabeceras personalizadas que alteran la respuesta.</li>
    <li><strong>HTTP Parameter Pollution</strong>: mandar parámetros duplicados para alterar el comportamiento de una petición.</li>
  </ul>

  <h3>Payloads de prueba recomendados</h3>
  <p>Si quieres saber si algo está mal, prueba cosas como:</p>
  <ul>
    <li><code>{{7*7}}</code> o <code>${7*7}</code> para SSTI</li>
    <li><code>../../etc/passwd</code> para path traversal</li>
    <li><code>javascript:alert(1)</code> en campos de URL</li>
    <li>Parámetros duplicados tipo <code>?id=1&id=2</code></li>
  </ul>
</div>

    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9778679469657985"
     crossorigin="anonymous"></script>
</body>
</html>
